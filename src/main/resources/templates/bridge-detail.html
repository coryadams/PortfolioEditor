<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: header"/>
<body class="page-body" data-url="http://neon.dev">
<div class="page-container">
    <!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->

    <div th:include="fragments/sidebar-menu :: sidebar" th:remove="tag"/>

    <div class="main-content">

        <div class="row">
            <!-- Raw Links -->
            <ul class="list-inline links-list pull-right">
                <li class="sep"></li>
                <li>
                    <div th:include="fragments/logout-links :: link" th:remove="tag"/>
                </li>
            </ul>
            <div th:inline="text">Logged in User: [[${#httpServletRequest.remoteUser}]]</div>
        </div>

        <hr/>
        <br/>


        <span th:text="|Bridge Name: ${bridge.yamName} |"/>
        <div class="row">
            <div class="col-sm-3">
                <div class="tile-stats tile-red">
                    <div class="icon"><i class="entypo-users"></i></div>
                    <div class="num" data-start="0" th:attr="data-end=*{totalConnections}" data-postfix=""
                         data-duration="1500" data-delay="0">0
                    </div>
                    <h3>Total Connections</h3>

                    <p></p>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="tile-stats tile-green">
                    <div class="icon"><i class="entypo-database"></i></div>
                    <div class="num" data-start="0" th:attr="data-end=*{queueDepth}" data-postfix=""
                         data-duration="1500" data-delay="600">0
                    </div>
                    <h3>Queue Depth</h3>

                    <p></p>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="tile-stats tile-aqua">
                    <div class="icon"><i class="entypo-chat"></i></div>
                    <div class="num" data-start="0" th:attr="data-end=*{messagesIn}" data-postfix=""
                         data-duration="1500" data-delay="1200">0
                    </div>
                    <h3>Messages In</h3>

                    <p></p>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="tile-stats tile-blue">
                    <div class="icon"><i class="entypo-rss"></i></div>
                    <div class="num" data-start="0" th:attr="data-end=*{messagesOut}" data-postfix=""
                         data-duration="1500" data-delay="1800">0
                    </div>
                    <h3>Messages Out</h3>

                    <p></p>
                </div>
            </div>
        </div>

        <br/>

        <div class="row">
            <div class="col-sm-8">
                <div class="panel panel-primary" id="charts_env">
                    <div class="panel-heading">
                        <div class="panel-title">Message Volume by Queue</div>
                        <div class="panel-options">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#line-chart" data-toggle="tab">Line Charts</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="line-chart">
                                <div id="line-chart-demo" class="morrischart" style="height: 300px"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <h4>
                                Real Time Stats
                                <br/>
                                <small>Current Message Volume</small>
                            </h4>
                        </div>
                        <div class="panel-options">
                            <a href="#" data-rel="collapse"><i class="entypo-down-open"></i></a>
                            <a href="#" data-rel="close"><i class="entypo-cancel"></i></a>
                        </div>
                    </div>
                    <div class="panel-body no-padding">
                        <div id="rickshaw-chart-demo">
                            <div id="rickshaw-legend"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <br/>
        <br/>

        <div class="row">
        </div>
        <!-- Footer -->
        <footer th:replace="fragments/footer :: footer"/>
    </div>
</div>
<script type="text/javascript">
    /*<![CDATA[*/
    jQuery(document).ready(function ($) {
        // Line Charts
        var line_chart_demo = $("#line-chart-demo");

        var line_chart = Morris.Line({
            element: 'line-chart-demo',
            data: [
                { y: '2014-10-12', a: 1000, b: 905 },
                { y: '2014-10-13', a: 750, b: 605 },
                { y: '2014-10-14', a: 500, b: 600 },
                { y: '2014-10-15', a: 750, b: 850 },
                { y: '2014-10-16', a: 500, b: 450 },
                { y: '2014-10-17', a: 750, b: 650 },
                { y: '2014-10-18', a: 800, b: 900 }
            ],
            xkey: 'y',
            ykeys: ['a', 'b'],
            labels: ['riskQueueA Avg Vol', 'riskQueueB Avg Vol'],
            redraw: true
        });

        line_chart_demo.parent().attr('style', '');

        // Rickshaw
        var seriesData = [
            [],
            []
        ];

        var random = new Rickshaw.Fixtures.RandomData(50);

        for (var i = 0; i < 50; i++) {
            random.addData(seriesData);
        }

        var graph = new Rickshaw.Graph({
            element: document.getElementById("rickshaw-chart-demo"),
            height: 193,
            renderer: 'area',
            stroke: false,
            preserve: true,
            series: [
                {
                    color: '#73c8ff',
                    data: seriesData[0],
                    name: 'riskQueueB'
                },
                {
                    color: '#e0f2ff',
                    data: seriesData[1],
                    name: 'riskQueueA'
                }
            ]
        });

        graph.render();

        var hoverDetail = new Rickshaw.Graph.HoverDetail({
            graph: graph,
            xFormatter: function (x) {
                return new Date(x * 1000).toString();
            }
        });

        var legend = new Rickshaw.Graph.Legend({
            graph: graph,
            element: document.getElementById('rickshaw-legend')
        });

        var highlighter = new Rickshaw.Graph.Behavior.Series.Highlight({
            graph: graph,
            legend: legend
        });

        setInterval(function () {
            random.removeData(seriesData);
            random.addData(seriesData);
            graph.update();

        }, 500);
    });

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    /*]]>*/
</script>
<th:block th:include="fragments/index-footer-links :: links"/>
</body>
</html>